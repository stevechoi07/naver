<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>v26.0 | ë‚´ ë™ë„¤ ì ìˆ˜ (ìµœì¢…)</title>
    <meta name="description" content="ë‚˜ë§Œì˜ ê¸°ì¤€ìœ¼ë¡œ ë™ë„¤ ì ìˆ˜ë¥¼ ë§¤ê²¨ë³´ì„¸ìš”! ê²€ìƒ‰ ê¸°ë¡ì´ ì ìˆ˜ë³„ë¡œ ì €ì¥ë˜ëŠ” 'ëª…ì˜ˆì˜ ì „ë‹¹' ê¸°ëŠ¥ìœ¼ë¡œ ìµœê³ ì˜ ë™ë„¤ë¥¼ ì°¾ì•„ë³´ì„¸ìš”.">
    <meta name="keywords" content="ë™ë„¤ ì ìˆ˜, ë­í‚¹, ëª…ì˜ˆì˜ ì „ë‹¹, localStorage, ìŠ¬ì„¸ê¶Œ, í¸ì˜ì‹œì„¤, ì‚´ê¸° ì¢‹ì€ ë™ë„¤, ì¹´ì¹´ì˜¤ë§µ">
    
    <meta property="og:title" content="ğŸ’¯ ë‚´ ë™ë„¤ ì ìˆ˜ - ìš°ë¦¬ ë™ë„¤ëŠ” ëª‡ ì ì¼ê¹Œ?">
    <meta property="og:description" content="ë‚˜ë§Œì˜ ê¸°ì¤€ìœ¼ë¡œ ë™ë„¤ì˜ ê°€ì¹˜ë¥¼ í‰ê°€í•´ë³´ì„¸ìš”!">
    <meta property="og:image" content="/img/og-image.png"> 
    <meta property="og:url" content="https://kfund.ai/dongs.html">
    <meta property="og:type" content="website">

    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=Bdae71c83941e7abbe59827c2625be7b&libraries=services"></script>
    
    <style>
        /* CSS ìŠ¤íƒ€ì¼ì€ ì´ì „ ë²„ì „ê³¼ ë™ì¼í•©ë‹ˆë‹¤ */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f8f9fa; color: #212529; }
        .main-container { background-color: #ffffff; border: 1px solid #dee2e6; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        .title-text { color: #0d6efd; }
        .input-field, .score-input { background-color: #f8f9fa; border-color: #ced4da; color: #212529; }
        .input-field:focus, .score-input:focus { border-color: #86b7fe; box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25); }
        .search-button { background-color: #0d6efd; color: #ffffff; transition: all 0.2s ease-in-out; }
        .search-button:hover { background-color: #0b5ed7; transform: translateY(-2px); }
        .result-card { background-color: #ffffff; border: 1px solid #e9ecef; }
        .summary-briefing { background-color: #e7f1ff; border: 1px solid #b6d4fe; color: #0a58ca; }
        .loader { border: 4px solid #dee2e6; border-top: 4px solid #0d6efd; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div class="main-container w-full max-w-2xl mx-auto rounded-2xl p-6 sm:p-8 space-y-8">
        
        <div class="relative text-center space-y-2">
            <div class="flex justify-center items-center">
                <h1 class="text-2xl sm:text-4xl font-bold title-text whitespace-nowrap">ğŸ’¯ ë‚´ ë™ë„¤ ì ìˆ˜ ğŸ’¯</h1>
            </div>
            <p class="text-gray-600 text-sm sm:text-base">ì¹´ì¹´ì˜¤ë§µ ë°ì´í„°ë¡œ ì •í™•í•˜ê²Œ ë¶„ì„í•˜ëŠ” ìš°ë¦¬ ë™ë„¤ ìŠ¬ì„¸ê¶Œ ì§€ìˆ˜!</p>
            <button id="service-share-btn" title="ì„œë¹„ìŠ¤ ê³µìœ í•˜ê¸°" class="absolute right-0 top-0 bg-gray-100 hover:bg-gray-200 text-gray-600 p-2 rounded-full transition">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M15 8a3 3 0 10-2.977-2.63l-4.94 2.47a3 3 0 100 4.319l4.94 2.47a3 3 0 10.895-1.789l-4.94-2.47a3.027 3.027 0 000-.74l4.94-2.47C13.456 7.68 14.19 8 15 8z" />
                </svg>
            </button>
        </div>

        <div class="bg-gray-50 p-4 rounded-lg border">
            <h3 class="font-bold text-center mb-3 text-gray-700">âš™ï¸ ë‚˜ë§Œì˜ ì ìˆ˜ ê¸°ì¤€ ì„¤ì •</h3>
            <div id="score-config-area" class="grid grid-cols-2 sm:grid-cols-3 gap-x-6 gap-y-3 text-sm"></div>
        </div>

        <div class="flex flex-col sm:flex-row gap-4">
            <input type="text" id="address" placeholder="ë™ë„¤ ì ìˆ˜ê°€ ê¶ê¸ˆí•œ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”!" class="input-field flex-grow p-4 border-2 rounded-lg" disabled>
            <button id="searchBtn" class="search-button font-bold py-4 px-6 sm:px-8 rounded-lg" disabled>ì´ˆê¸°í™” ì¤‘...</button>
        </div>

        <div id="result" class="pt-6">
            <div id="initial-message" class="text-center text-gray-500">
                <p>ğŸ›°ï¸ ì¹´ì¹´ì˜¤ë§µ ì„œë¹„ìŠ¤ ì´ˆê¸°í™” ì¤‘...</p>
            </div>
            <div id="loading" class="hidden flex flex-col items-center justify-center space-y-4">
                <div class="loader"></div>
                <p class="text-blue-600 font-semibold">ì¹´ì¹´ì˜¤ë§µì—ì„œ í¸ì˜ì‹œì„¤ ì •ë³´ ìˆ˜ì‹  ì¤‘...</p>
            </div>
            <div id="result-content" class="hidden relative">
                <h2 id="result-message" class="text-xl sm:text-2xl font-bold text-center mb-6"></h2>
                <div class="relative mb-6">
                    <div id="map" class="w-full h-80 rounded-lg border-2 border-gray-300"></div>
                    <div id="map-legend" class="absolute bottom-2 left-2 bg-white bg-opacity-80 p-2 rounded-md shadow-md text-xs space-y-1 z-10 hidden"></div>
                </div>
                <div id="summary-briefing" class="summary-briefing mb-6 p-4 rounded-lg"></div>
                <div id="facility-list" class="space-y-4"></div>
            </div>
        </div>

        <div id="ranking-section" class="pt-6 border-t">
            <h3 class="text-xl font-bold text-center text-yellow-500 mb-4">ğŸ† ëª…ì˜ˆì˜ ì „ë‹¹ ğŸ†</h3>
            <ol id="ranking-list" class="space-y-2 text-sm"></ol>
        </div>
        
    </div>

    <script>
        // --- DOM Elements ---
        const addressInput = document.getElementById('address');
        const searchBtn = document.getElementById('searchBtn');
        const scoreConfigArea = document.getElementById('score-config-area');
        const resultContentDiv = document.getElementById('result-content');
        const resultMessage = document.getElementById('result-message');
        const rankingList = document.getElementById('ranking-list');
        const initialMessageDiv = document.getElementById('initial-message');
        const loadingDiv = document.getElementById('loading');
        const summaryBriefing = document.getElementById('summary-briefing');
        const facilityList = document.getElementById('facility-list');
        const mapContainer = document.getElementById('map');
        const mapLegend = document.getElementById('map-legend');
        const serviceShareBtn = document.getElementById('service-share-btn');

        // --- Global Variables & Config ---
        let geocoderInstance = null; let placesInstance = null; let map = null; let overlays = [];
        const amenityConfig = { convenience: { name: 'ğŸª í¸ì˜ì ', category: 'CS2', score: 5, color: '#2C78E5' }, cafe: { name: 'â˜• ì¹´í˜', category: 'CE7', score: 3, color: '#D5A16A' }, hospital: { name: 'ğŸ¥ ë³‘ì›/ì•½êµ­', category: 'HP8,PM9', score: 10, color: '#E54545' }, park: { name: 'ğŸŒ³ ê³µì›', keyword: 'ê³µì›', score: 8, color: '#31A24C' }, subway: { name: 'ğŸš‡ ì§€í•˜ì² ì—­', category: 'SW8', score: 15, color: '#8A3E99' }, bank: { name: 'ğŸ¦ ì€í–‰', category: 'BK9', score: 4, color: '#F2994A' }, default: { name: 'ğŸ“ ê¸°íƒ€ì‹œì„¤', color: '#777777' } };

        // --- localStorage & Rendering Functions ---
        function getRankings() { const rankingsJSON = localStorage.getItem('dongneRankings'); return rankingsJSON ? JSON.parse(rankingsJSON) : []; }
        function saveRankings(rankings) { localStorage.setItem('dongneRankings', JSON.stringify(rankings)); }
        function renderRankings() { const rankings = getRankings(); if (rankings.length === 0) { rankingList.innerHTML = '<li class="text-center text-gray-500">ì•„ì§ ì €ì¥ëœ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</li>'; return; } rankingList.innerHTML = rankings.map((item, index) => `<li class="flex justify-between items-center bg-gray-50 p-3 rounded-lg hover:bg-yellow-50 transition"><span class="font-bold text-lg text-gray-500 w-8">${index + 1}.</span><span class="flex-grow mx-2 font-semibold text-gray-800 truncate">${item.address}</span><span class="font-bold text-blue-600 text-lg">${item.score}ì </span></li>`).join('');}
        function renderScoreInputs() { let html = ''; for (const key in amenityConfig) { if (key === 'default') continue; const amenity = amenityConfig[key]; html += `<div class="flex items-center justify-between"><label for="score-input-${key}" class="font-medium text-gray-600">${amenity.name}</label><input type="number" id="score-input-${key}" value="${amenity.score}" min="0" class="score-input w-16 p-1 text-center border rounded-md outline-none"></div>`; } scoreConfigArea.innerHTML = html; }
        
        // --- Initialization ---
        kakao.maps.load(() => { try { geocoderInstance = new kakao.maps.services.Geocoder(); placesInstance = new kakao.maps.services.Places(); initializeSearch(); } catch (error) { displayError("ì¹´ì¹´ì˜¤ë§µ ì„œë¹„ìŠ¤ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."); } });
        function initializeSearch() { 
            addressInput.disabled = false; 
            searchBtn.disabled = false; 
            searchBtn.textContent = 'ì ìˆ˜ í™•ì¸'; 
            initialMessageDiv.innerHTML = `<p>ğŸ‘†ğŸ» ìƒë‹¨ì— ì£¼ì†Œë¥¼ ì…ë ¥í•˜ê³  'ì ìˆ˜ í™•ì¸' ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>`; 
            renderScoreInputs(); 
            renderRankings(); 
            searchBtn.addEventListener('click', startSearch); 
            addressInput.addEventListener('keydown', (event) => { if (event.key === 'Enter') startSearch(); }); 
        }

        serviceShareBtn.addEventListener('click', async () => {
            const shareData = {
                title: 'ğŸ’¯ ë‚´ ë™ë„¤ ì ìˆ˜',
                text: 'ìš°ë¦¬ ë™ë„¤ ëª‡ ì  ë‚˜ì™”ê²Œ? ë„¤ ë™ë„¤ë„ ì§€ê¸ˆ ë°”ë¡œ í™•ì¸í•´ë´! ğŸ¤£',
                url: window.location.href
            };

            if (navigator.share) {
                try {
                    await navigator.share(shareData);
                } catch (err) {
                    console.log("Share Canceled");
                }
            } else {
                try {
                    await navigator.clipboard.writeText(shareData.url);
                    alert('í˜ì´ì§€ ì£¼ì†Œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì›í•˜ëŠ” ê³³ì— ë¶™ì—¬ë„£ê¸° í•´ì£¼ì„¸ìš”!');
                } catch (err) {
                    alert('ì£¼ì†Œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            }
        });

        // --- Core Search Logic ---
        function clearMap() { overlays.forEach(overlay => overlay.setMap(null)); overlays = []; mapContainer.classList.add('hidden'); mapLegend.classList.add('hidden'); }
        function startSearch() { const address = addressInput.value; if (!address) { addressInput.classList.add('border-red-500'); setTimeout(() => addressInput.classList.remove('border-red-500'), 1500); return; } initialMessageDiv.classList.add('hidden'); resultContentDiv.classList.add('hidden'); loadingDiv.classList.remove('hidden'); geocoderInstance.addressSearch(address, (result, status) => { if (status === kakao.maps.services.Status.OK) { const lat = result[0].y; const lon = result[0].x; findAllAmenities(lat, lon); } else { displayError('ğŸ˜­ ì£¼ì†Œë¥¼ ì¢Œí‘œë¡œ ë³€í™˜í•˜ëŠ”ë° ì‹¤íŒ¨í–ˆì–´ìš”. ì •í™•í•œ ì£¼ì†Œì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”!'); } }); }
        async function findAllAmenities(lat, lon) { const searchRadius = 500; const searchPromises = []; const location = new kakao.maps.LatLng(lat, lon); for (const key in amenityConfig) { if (key === 'default') continue; const amenity = amenityConfig[key]; const promise = new Promise((resolve) => { const options = { location, radius: searchRadius, sort: kakao.maps.services.SortBy.DISTANCE }; const callback = (result, status) => { if (status === kakao.maps.services.Status.OK) { resolve(result.map(place => ({ ...place, amenityType: key }))); } else { resolve([]); } }; if (amenity.keyword) { placesInstance.keywordSearch(amenity.keyword, callback, options); } else if (amenity.category) { placesInstance.categorySearch(amenity.category.split(',')[0], callback, options); } else { resolve([]); } }); searchPromises.push(promise); } try { const resultsArray = await Promise.all(searchPromises); const allPlaces = resultsArray.flat(); calculateScoreAndDisplayResults(allPlaces, lat, lon); } catch (error) { displayError('ğŸ˜­ í¸ì˜ì‹œì„¤ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”.'); } }
        function calculateScoreAndDisplayResults(places, centerLat, centerLon) { const currentAmenityConfig = JSON.parse(JSON.stringify(amenityConfig)); for (const key in currentAmenityConfig) { if (key === 'default') continue; const inputElement = document.getElementById(`score-input-${key}`); if (inputElement) { currentAmenityConfig[key].score = parseInt(inputElement.value, 10) || 0; } } const results = { totalScore: 0, facilities: [], counts: {} }; const uniquePlaces = new Map(); places.forEach(place => { if (!uniquePlaces.has(place.id)) { uniquePlaces.set(place.id, place); } }); uniquePlaces.forEach(place => { const type = place.amenityType; if (!results.counts[type]) results.counts[type] = 0; results.counts[type]++; results.totalScore += currentAmenityConfig[type].score; results.facilities.push(place); }); if (results.facilities.length > 0) { displaySuccess(results, centerLat, centerLon); } else { displayNotFound(); } }
        
        // --- Display Functions ---
        function displayResult() { loadingDiv.classList.add('hidden'); resultContentDiv.classList.remove('hidden'); resultContentDiv.classList.add('fade-in'); }
        function displaySuccess(results, centerLat, centerLon) { 
            displayResult(); 
            results.facilities.sort((a, b) => a.distance - b.distance); 
            let scoreMessage = ''; if (results.totalScore >= 100) scoreMessage = `ğŸ¥³ ${results.totalScore}ì ! ì—¬ê¸°ëŠ” ì²œêµ­ì¸ê°€ìš”? ì™„ë²½í•œ ë™ë„¤ë„¤ìš”!`; else if (results.totalScore >= 70) scoreMessage = `ğŸ˜ ${results.totalScore}ì ! ì‚´ê¸° ì¢‹ì€ ë©‹ì§„ ë™ë„¤ì…ë‹ˆë‹¤!`; else if (results.totalScore >= 40) scoreMessage = `ğŸ™‚ ${results.totalScore}ì ! ê´œì°®ì•„ìš”, ì¶©ë¶„íˆ ì¢‹ì€ ë™ë„¤ì˜ˆìš”.`; else scoreMessage = `ğŸ¤” ${results.totalScore}ì ... ì¡°ê¸ˆì€ ì•„ì‰½ì§€ë§Œ, ì •ê²¨ìš´ ìš°ë¦¬ ë™ë„¤!`; 
            resultMessage.innerHTML = scoreMessage; 
            const currentAddress = addressInput.value; let rankings = getRankings(); rankings = rankings.filter(item => item.address !== currentAddress); rankings.push({ address: currentAddress, score: results.totalScore }); rankings.sort((a, b) => b.score - a.score); const topRankings = rankings.slice(0, 10); saveRankings(topRankings); renderRankings();
            let briefingHTML = `<h3 class="font-bold text-lg mb-2">ğŸ“Š ë‚´ ë™ë„¤ ì ìˆ˜ ì„¸ë¶€ë‚´ì—­</h3><div class="space-y-1 text-sm">`; for(const key in results.counts) { if(results.counts[key] > 0) { briefingHTML += `<div>- ${amenityConfig[key].name}: <strong class="text-gray-800">${results.counts[key]}</strong>ê°œ ë°œê²¬!</div>`; } } briefingHTML += `</div>`; summaryBriefing.innerHTML = briefingHTML; 
            facilityList.innerHTML = ''; results.facilities.forEach(place => { const typeInfo = amenityConfig[place.amenityType]; const cardHTML = `<div class="result-card p-4 rounded-lg"><div class="flex justify-between items-center"><h4 class="font-bold text-lg text-blue-700">${place.place_name}</h4><span class="font-semibold text-gray-800 bg-gray-200 px-3 py-1 rounded-full text-sm">${place.distance}m</span></div><div class="mt-2 text-sm text-gray-700"><span>${typeInfo.name}</span></div></div>`; facilityList.innerHTML += cardHTML; }); 
            displayMap(results.facilities, centerLat, centerLon); 
        }
        function displayMap(facilities, centerLat, centerLon) { mapContainer.classList.remove('hidden'); const centerPosition = new kakao.maps.LatLng(centerLat, centerLon); const mapOption = { center: centerPosition, level: 5 }; map = new kakao.maps.Map(mapContainer, mapOption); const userMarkerImage = new kakao.maps.MarkerImage('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png', new kakao.maps.Size(24, 35), { offset: new kakao.maps.Point(12, 35) }); const userMarker = new kakao.maps.Marker({ position: centerPosition, image: userMarkerImage }); userMarker.setMap(map); overlays.push(userMarker); const infowindow = new kakao.maps.InfoWindow({ removable: true }); facilities.forEach(place => { const position = new kakao.maps.LatLng(place.y, place.x); const typeInfo = amenityConfig[place.amenityType] || amenityConfig.default; const circle = new kakao.maps.Circle({ map: map, center: position, radius: 8, strokeWeight: 2, strokeColor: '#fff', strokeOpacity: 1, fillColor: typeInfo.color, fillOpacity: 0.9 }); overlays.push(circle); const iwContent = `<div style="padding:5px; font-size:12px; max-width: 250px;"><div style="font-weight:bold; color:#0d6efd;">${place.place_name}</div><div>(${typeInfo.name})</div><div>ê±°ë¦¬: ${place.distance}m</div></div>`; kakao.maps.event.addListener(circle, 'mouseover', () => { infowindow.setContent(iwContent); infowindow.setPosition(position); infowindow.open(map); }); kakao.maps.event.addListener(circle, 'mouseout', () => { infowindow.close(); }); }); }
        function displayNotFound() { displayResult(); resultMessage.innerHTML = `<span class="text-yellow-600 font-bold">ğŸ§ ì£¼ë³€ 500m ë‚´ì— ì£¼ìš” í¸ì˜ì‹œì„¤ ì •ë³´ê°€ ë“±ë¡ë˜ì–´ ìˆì§€ ì•Šì•„ìš”.</span>`; summaryBriefing.innerHTML = ''; facilityList.innerHTML = ''; clearMap(); }
        function displayError(message) { displayResult(); resultMessage.innerHTML = `<span class="text-red-600 font-bold">âš ï¸ ${message}</span>`; summaryBriefing.innerHTML = ''; facilityList.innerHTML = ''; clearMap(); }
    </script>
</body>
</html>