<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML ì²­ì§„ê¸° v2.1 - ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ ì „ë¬¸ ë¶„ì„</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .result-grid { display: grid; grid-template-columns: 1fr 2fr; gap: 8px; }
        .loader { border-top-color: #3498db; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-4xl bg-white rounded-2xl shadow-2xl p-8 space-y-6">
        
        <header class="text-center">
            <h1 class="text-4xl font-bold text-gray-900">ğŸ©º HTML ì²­ì§„ê¸° v2.1</h1>
            <p class="text-lg text-gray-600 mt-2">ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ ì „ë¬¸ í´ë¦¬ë‹‰</p>
        </header>

        <div class="space-y-4">
            <div>
                <label for="html-input" class="block text-sm font-medium text-gray-700 mb-2">1. ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ HTML ì½”ë“œ ë¶™ì—¬ë„£ê¸°:</label>
                <textarea id="html-input" rows="10" class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200" placeholder="[Ctrl+A]ë¡œ ì „ì²´ ì„ íƒ í›„ [Ctrl+C]ë¡œ ë³µì‚¬í•œ HTML ì†ŒìŠ¤ ì½”ë“œë¥¼ ì—¬ê¸°ì— [Ctrl+V]ë¡œ ë¶™ì—¬ë„£ì–´ ì£¼ì„¸ìš”."></textarea>
            </div>

            <button id="analyze-button" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-200 text-lg">
                ë¶„ì„ ì‹œì‘!
            </button>
        </div>

        <!-- ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->
        <div id="status-message" class="text-center p-4 rounded-lg bg-gray-50 hidden"></div>
        
        <div class="space-y-6">
            <!-- [v2.1] ì‹ ê·œ ê¸°ëŠ¥: ìƒí’ˆëª… í‘œì‹œ ì˜ì—­ ì¶”ê°€! -->
            <div>
                <h2 class="text-2xl font-semibold border-b-2 border-gray-200 pb-2 mb-4">ìƒí’ˆëª…</h2>
                <div id="product-name-result" class="p-4 bg-gray-50 rounded-lg min-h-[50px] text-xl font-semibold">ë¶„ì„ ëŒ€ê¸° ì¤‘...</div>
            </div>
            <div>
                <h2 class="text-2xl font-semibold border-b-2 border-gray-200 pb-2 mb-4">ìƒí’ˆ ì†ì„±</h2>
                <div id="attributes-result" class="p-4 bg-gray-50 rounded-lg min-h-[100px]">ë¶„ì„ ëŒ€ê¸° ì¤‘...</div>
            </div>
            <div>
                <h2 class="text-2xl font-semibold border-b-2 border-gray-200 pb-2 mb-4">ê´€ë ¨ íƒœê·¸</h2>
                <div id="tags-result" class="p-4 bg-gray-50 rounded-lg min-h-[50px] flex flex-wrap gap-2">ë¶„ì„ ëŒ€ê¸° ì¤‘...</div>
            </div>
        </div>
    </div>

    <script>
        const analyzeButton = document.getElementById('analyze-button');
        const htmlInput = document.getElementById('html-input');
        const statusMessage = document.getElementById('status-message');
        // [v2.1] ì‹ ê·œ ê¸°ëŠ¥: ìƒí’ˆëª… ì—˜ë¦¬ë¨¼íŠ¸ ê°€ì ¸ì˜¤ê¸°
        const productNameResult = document.getElementById('product-name-result');
        const attributesResult = document.getElementById('attributes-result');
        const tagsResult = document.getElementById('tags-result');

        analyzeButton.addEventListener('click', async () => {
            const htmlContent = htmlInput.value;

            if (!htmlContent.trim()) {
                showMessage('HTML ì½”ë“œë¥¼ ë¶™ì—¬ë„£ì–´ ì£¼ì„¸ìš”.', 'error');
                return;
            }

            // ì´ˆê¸°í™” ë° ë¡œë”© ìƒíƒœ í‘œì‹œ
            // [v2.1] ì‹ ê·œ ê¸°ëŠ¥: ìƒí’ˆëª… ì˜ì—­ ì´ˆê¸°í™”
            productNameResult.innerHTML = '';
            attributesResult.innerHTML = '';
            tagsResult.innerHTML = '';
            showMessage('ì²œì¬ ì™¸ê³¼ì˜ê°€ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤... ğŸ©º', 'loading');

            try {
                const response = await fetch('/.netlify/functions/fetch-info', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ html: htmlContent })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `ì„œë²„ ì—ëŸ¬: ${response.status}`);
                }

                const data = await response.json();
                
                showMessage('ë¶„ì„ ì™„ë£Œ! ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”.', 'success');
                displayResults(data);

            } catch (error) {
                showMessage(`ë¶„ì„ ì‹¤íŒ¨: ${error.message}`, 'error');
                // [v2.1] ì‹ ê·œ ê¸°ëŠ¥: ìƒí’ˆëª… ì˜ì—­ ì—ëŸ¬ ë©”ì‹œì§€
                productNameResult.textContent = 'ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
                attributesResult.textContent = 'ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
                tagsResult.textContent = 'ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
            }
        });

        function showMessage(message, type) {
            statusMessage.textContent = message;
            statusMessage.className = 'text-center p-4 rounded-lg'; // Reset classes
            statusMessage.classList.remove('hidden');

            if (type === 'loading') {
                statusMessage.classList.add('bg-blue-100', 'text-blue-800');
            } else if (type === 'success') {
                statusMessage.classList.add('bg-green-100', 'text-green-800');
            } else if (type === 'error') {
                statusMessage.classList.add('bg-red-100', 'text-red-800');
            }
        }

        // [v2.1] ì‹ ê·œ ê¸°ëŠ¥: íŒŒë¼ë¯¸í„°ì— productName ì¶”ê°€!
        function displayResults({ productName, attributes, tags }) {
            // ìƒí’ˆëª… í‘œì‹œ
            if (productName) {
                productNameResult.textContent = productName;
            } else {
                productNameResult.textContent = 'ì¶”ì¶œëœ ìƒí’ˆëª…ì´ ì—†ìŠµë‹ˆë‹¤.';
            }

            // ìƒí’ˆ ì†ì„± í‘œì‹œ
            if (attributes && attributes.length > 0) {
                const grid = document.createElement('div');
                grid.className = 'result-grid';
                attributesResult.innerHTML = ''; // Clear previous results
                attributes.forEach(({ key, value }) => {
                    const keyEl = document.createElement('div');
                    keyEl.className = 'font-semibold bg-white p-2 rounded';
                    keyEl.textContent = key;
                    grid.appendChild(keyEl);

                    const valueEl = document.createElement('div');
                    valueEl.className = 'bg-white p-2 rounded';
                    valueEl.textContent = value;
                    grid.appendChild(valueEl);
                });
                attributesResult.appendChild(grid);
} else {
                attributesResult.textContent = 'ì¶”ì¶œëœ ìƒí’ˆ ì†ì„±ì´ ì—†ìŠµë‹ˆë‹¤.';
            }

            // ê´€ë ¨ íƒœê·¸ í‘œì‹œ
            if (tags && tags.length > 0) {
                tagsResult.innerHTML = ''; // Clear previous results
                tags.forEach(tag => {
                    const tagEl = document.createElement('span');
                    tagEl.className = 'bg-blue-200 text-blue-800 text-sm font-medium px-3 py-1 rounded-full';
                    tagEl.textContent = tag;
                    tagsResult.appendChild(tagEl);
                });
            } else {
                tagsResult.textContent = 'ì¶”ì¶œëœ ê´€ë ¨ íƒœê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.';
            }
        }
    </script>

</body>
</html>